<h1>Search Results</h1>

<div id="map" style="height: 500px;"></div>  <!-- Create a div for the map -->

{{#if earthquakes.length}}
  <ul>
    {{#each earthquakes}}
      <li>
        <strong>Location:</strong> {{this.properties.place}}<br>
        <strong>Magnitude:</strong> {{this.properties.mag}}<br>
        <strong>Time:</strong> {{this.properties.time}}
      </li>
    {{/each}}
  </ul>
{{else}}
  <p>No earthquakes found for the selected criteria.</p>
{{/if}}

<script>
  // Initialize the map centered on San Francisco
  var map = L.map('map').setView([37.7749, -122.4194], 5);

  // Add OpenStreetMap tiles (map background)
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
  }).addTo(map);

  // Add markers for earthquakes
  var earthquakes = {{{json earthquakes}}};  // Pass earthquake data as JSON

  earthquakes.forEach(function(earthquake) {
    var lat = earthquake.geometry.coordinates[1];
    var lon = earthquake.geometry.coordinates[0];
    var mag = earthquake.properties.mag;
    var place = earthquake.properties.place;

    L.marker([lat, lon]).addTo(map)
      .bindPopup(`<strong>Location:</strong> ${place}<br><strong>Magnitude:</strong> ${mag}`);
  });
</script>